@import 'tailwindcss';

@custom-variant dark (&:where(.dark, .dark *));

@theme {
  --animate-fade-in: fade-in 0.4s ease-out both;
  --animate-fade-in-up: fade-in-up 0.45s ease-out both;
  --animate-slide-down: slide-down 0.25s ease-out both;
  --animate-scale-in: scale-in 0.35s ease-out both;
  --animate-pop-in: pop-in 0.3s cubic-bezier(0.34, 1.56, 0.64, 1) both;

  @keyframes fade-in {
    0% {
      opacity: 0;
    }
    100% {
      opacity: 1;
    }
  }
  @keyframes fade-in-up {
    0% {
      opacity: 0;
      transform: translateY(12px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }
  @keyframes slide-down {
    0% {
      opacity: 0;
      transform: translateY(-8px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }
  @keyframes scale-in {
    0% {
      opacity: 0;
      transform: scale(0.96);
    }
    100% {
      opacity: 1;
      transform: scale(1);
    }
  }
  @keyframes pop-in {
    0% {
      opacity: 0;
      transform: scale(0.9);
    }
    100% {
      opacity: 1;
      transform: scale(1);
    }
  }
}

/* ── v3 compatibility base styles ── */
@layer base {
  /* Default border color (v4 changed to currentColor) */
  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    border-color: var(--color-gray-200, currentcolor);
  }

  /* Buttons use cursor:pointer (v4 changed to default) */
  button:not(:disabled),
  [role="button"]:not(:disabled) {
    cursor: pointer;
  }
}

/* ── Skeleton animation ── */
@keyframes shimmer {
  0% { background-position: -200% 0; }
  100% { background-position: 200% 0; }
}
.skeleton {
  background: linear-gradient(90deg, #e5e7eb 25%, #d1d5db 37%, #e5e7eb 63%);
  background-size: 200% 100%;
  animation: shimmer 1.4s ease-in-out infinite;
  border-radius: 4px;
}
.dark .skeleton {
  background: linear-gradient(90deg, #374151 25%, #4b5563 37%, #374151 63%);
  background-size: 200% 100%;
}
.skeleton-text { height: 0.75rem; border-radius: 4px; }
.skeleton-text-lg { height: 1rem; border-radius: 4px; }
.skeleton-badge { height: 1.25rem; width: 3.5rem; border-radius: 9999px; }
.skeleton-score { height: 1.75rem; width: 2.5rem; border-radius: 6px; }

/* ── Global top progress bar ── */
@keyframes progress-indeterminate {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(250%); }
}
#global-progress {
  position: fixed; top: 0; left: 0; width: 100%; height: 3px;
  z-index: 9999; opacity: 0; transition: opacity 150ms;
  overflow: hidden; background: transparent;
}
#global-progress.htmx-request { opacity: 1; }
#global-progress .bar {
  width: 40%; height: 100%;
  background: linear-gradient(90deg, transparent, #818cf8, #a78bfa, transparent);
  animation: progress-indeterminate 1s ease-in-out infinite;
}

/* ── HTMX indicator helpers ── */
.htmx-indicator { opacity: 0; transition: opacity 200ms; }
.htmx-request .htmx-indicator,
.htmx-request.htmx-indicator { opacity: 1; }

/* ── Spinner for buttons ── */
@keyframes spin {
  to { transform: rotate(360deg); }
}
.spinner {
  display: inline-block; width: 14px; height: 14px;
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-top-color: white; border-radius: 50%;
  animation: spin 0.6s linear infinite;
  vertical-align: middle; margin-left: 4px;
}

/* ── Toast notifications ── */
@keyframes toast-in {
  from { transform: translateX(100%); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}
@keyframes toast-out {
  from { transform: translateX(0); opacity: 1; }
  to { transform: translateX(100%); opacity: 0; }
}
.toast-enter { animation: toast-in 0.3s ease-out forwards; }
.toast-exit { animation: toast-out 0.25s ease-in forwards; }

/* ── Stagger delays (!important overrides animation shorthand) ── */
.stagger-1 { animation-delay: 60ms !important; }
.stagger-2 { animation-delay: 120ms !important; }
.stagger-3 { animation-delay: 180ms !important; }
.stagger-4 { animation-delay: 240ms !important; }
.stagger-5 { animation-delay: 300ms !important; }
.stagger-6 { animation-delay: 360ms !important; }
.stagger-7 { animation-delay: 420ms !important; }
.stagger-8 { animation-delay: 480ms !important; }
.stagger-9 { animation-delay: 540ms !important; }

/* ── HTMX content swap fade ── */
.htmx-swapping { opacity: 0; transition: opacity 0.15s ease-out; }
.htmx-settling { opacity: 1; transition: opacity 0.2s ease-in; }

/* ── Respect reduced motion preference ── */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* ── Skeleton overlay for swap targets ── */
.skeleton-overlay {
  position: absolute; inset: 0; z-index: 10;
  background: white; border-radius: 12px;
  opacity: 0; pointer-events: none; transition: opacity 150ms;
}
.dark .skeleton-overlay { background: #1f2937; }
.htmx-request .skeleton-overlay { opacity: 1; pointer-events: auto; }
