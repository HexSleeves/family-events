{% extends "base.html" %}
{% block title %}Sources{% endblock %}
{% block content %}

<div class="animate-fade-in">
  <h1 class="text-2xl font-bold text-[var(--color-heading)] mb-6">ğŸ“¡ Event Sources</h1>

  {# â•â•â• ADD SOURCE â•â•â• #}
  {% if current_user %}
  <form hx-post="/api/sources" hx-swap="none" hx-indicator="#add-spinner"
      class="bg-[var(--color-surface)] rounded-xl p-5 border border-[var(--color-edge-subtle)] shadow-[var(--shadow-xs)] mb-6 animate-fade-in-up stagger-1">
    <h3 class="font-semibold text-[var(--color-heading)] mb-3">Add Custom Source</h3>
    <div class="flex flex-col sm:flex-row gap-3">
      <div class="flex-1">
        <input type="url" name="url" required placeholder="https://example.com/events"
            class="w-full px-3.5 py-2.5 border border-[var(--color-edge)] rounded-lg text-sm bg-[var(--color-surface-secondary)] text-[var(--color-heading)] placeholder:text-[var(--color-faint)] focus:outline-hidden focus:ring-2 focus:ring-[var(--color-brand)]/30 focus:border-[var(--color-brand)] transition-all" />
      </div>
      <div class="w-full sm:w-48">
        <input type="text" name="name" placeholder="Name (optional)"
            class="w-full px-3.5 py-2.5 border border-[var(--color-edge)] rounded-lg text-sm bg-[var(--color-surface-secondary)] text-[var(--color-heading)] placeholder:text-[var(--color-faint)] focus:outline-hidden focus:ring-2 focus:ring-[var(--color-brand)]/30 focus:border-[var(--color-brand)] transition-all" />
      </div>
      <button type="submit"
          class="px-5 py-2.5 rounded-lg bg-[var(--color-brand)] text-white font-medium text-sm hover:bg-[var(--color-brand-hover)] active:scale-[0.98] transition-all flex items-center gap-2">
        Add Source
        <span id="add-spinner" class="htmx-indicator spinner"></span>
      </button>
    </div>
  </form>
  {% endif %}

  {# â•â•â• BUILT-IN SOURCES â•â•â• #}
  <h2 class="text-lg font-semibold text-[var(--color-heading)] mb-3 animate-fade-in-up stagger-2">Built-in Sources</h2>
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-8">
    {% set builtins = [
      ('BREC Parks', 'brec.org', 'Baton Rouge parks & recreation', 'ğŸï¸'),
      ('Eventbrite', 'eventbrite.com', 'Both cities', 'ğŸ«'),
      ('AllEvents.in', 'allevents.in', 'Both cities', 'ğŸŒ'),
      ('Lafayette Venues', 'Various', 'Moncus Park, Acadiana Arts, Science Museum', 'ğŸ '),
      ('Libraries', 'LibCal', 'Lafayette & BR libraries', 'ğŸ“š')
    ] %}
    {% for name, domain, desc, icon in builtins %}
    <div class="bg-[var(--color-surface)] rounded-xl p-4 border border-[var(--color-edge-subtle)] shadow-[var(--shadow-xs)] animate-fade-in-up stagger-{{ loop.index + 2 }}">
      <div class="flex items-center gap-3">
        <span class="text-2xl">{{ icon }}</span>
        <div>
          <h3 class="font-semibold text-[var(--color-heading)] text-sm">{{ name }}</h3>
          <p class="text-xs text-[var(--color-muted)]">{{ desc }}</p>
        </div>
        <span class="ml-auto px-2 py-0.5 rounded-full text-xs font-medium bg-[var(--color-success-light)] text-[var(--color-success)]">Active</span>
      </div>
    </div>
    {% endfor %}
  </div>

  {# â•â•â• CUSTOM SOURCES â•â•â• #}
  {% if sources %}
  <h2 class="text-lg font-semibold text-[var(--color-heading)] mb-3">Custom Sources</h2>
  <div class="space-y-3">
    {% for source in sources %}
    {% include "partials/_source_card.html" %}
    {% endfor %}
  </div>
  {% endif %}
</div>

{% endblock %}
